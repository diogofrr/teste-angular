<div class="products-list-container">
  <div class="header">
    <h1>Lista de Produtos</h1>
    <p-button
      label="Novo Produto"
      icon="pi pi-plus"
      (onClick)="navigateToCreate()"
      [raised]="true"
    ></p-button>
  </div>

  <p-table
    [value]="filteredProducts"
    [loading]="loading"
    [paginator]="true"
    [rows]="10"
    [rowsPerPageOptions]="[5, 10, 20]"
    [globalFilterFields]="['name', 'description', 'category']"
    styleClass="p-datatable-striped"
    [tableStyle]="{ 'min-width': '50rem' }"
  >
    <ng-template pTemplate="caption">
      <div class="table-header">
        <span class="p-input-icon-left">
          <i class="pi pi-search"></i>
          <input
            type="text"
            pInputText
            placeholder="Buscar produtos..."
            #searchInput
            (input)="filterProducts(searchInput.value)"
          />
        </span>
      </div>
    </ng-template>

    <ng-template pTemplate="header">
      <tr>
        <th>Nome</th>
        <th>Descrição</th>
        <th>Categoria</th>
        <th>Preço</th>
        <th>Criado em</th>
        <th style="width: 10rem">Ações</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-product>
      <tr>
        <td>{{ product.name }}</td>
        <td>{{ product.description }}</td>
        <td>
          <p-tag [value]="product.category" severity="info"></p-tag>
        </td>
        <td>{{ formatPrice(product.price) }}</td>
        <td>{{ formatDate(product.createdAt) }}</td>
        <td>
          <div class="actions">
            <p-button
              icon="pi pi-pencil"
              [rounded]="true"
              [text]="true"
              severity="info"
              (onClick)="navigateToEdit(product.id)"
              pTooltip="Editar"
            ></p-button>
            <p-button
              icon="pi pi-trash"
              [rounded]="true"
              [text]="true"
              severity="danger"
              (onClick)="confirmDelete(product)"
              pTooltip="Excluir"
            ></p-button>
          </div>
        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="6" class="empty-message">
          Nenhum produto encontrado. Clique em "Novo Produto" para adicionar um.
        </td>
      </tr>
    </ng-template>
  </p-table>

  <p-confirmDialog></p-confirmDialog>
  <p-toast></p-toast>
</div>
